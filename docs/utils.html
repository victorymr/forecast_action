---

title: fcst_campaign utils module


keywords: fastai
sidebar: home_sidebar

summary: "Some generic tools"
description: "Some generic tools"
nb_path: "01_utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Rounded Coordinates for Chicago: Latitude 42.0, Longitude -87.75
{&#39;lat_lon&#39;: (40.7128, -74.006), &#39;time_zone&#39;: &#39;America/New_York&#39;, &#39;local_peak_start&#39;: &#39;2024-03-07 05:00:00&#39;, &#39;local_peak_end&#39;: &#39;2024-03-07 12:00:00&#39;}
{&#39;lat_lon&#39;: (28.6139, 77.209), &#39;time_zone&#39;: &#39;Asia/Kolkata&#39;, &#39;local_peak_start&#39;: &#39;2024-03-07 15:30:00&#39;, &#39;local_peak_end&#39;: &#39;2024-03-07 22:30:00&#39;}
Timezone offset for latitude 40.7128, longitude -74.006 is -5.0 hours.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">IN_COLAB</span> <span class="o">=</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">())</span>
<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
  <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/pete88b/nbdev_colab_helper.git
  <span class="kn">from</span> <span class="nn">nbdev_colab_helper.core</span> <span class="kn">import</span> <span class="o">*</span>
  <span class="n">project_name</span> <span class="o">=</span> <span class="s1">&#39;forecast_action&#39;</span>
  <span class="n">init_notebook</span><span class="p">(</span><span class="n">project_name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting git+https://github.com/pete88b/nbdev_colab_helper.git
  Cloning https://github.com/pete88b/nbdev_colab_helper.git to /tmp/pip-req-build-38eit630
  Running command git clone --filter=blob:none --quiet https://github.com/pete88b/nbdev_colab_helper.git /tmp/pip-req-build-38eit630
  Resolved https://github.com/pete88b/nbdev_colab_helper.git to commit 15cf67b6ca0c125a636cedc017f285a04771bbff
  Preparing metadata (setup.py) ... done
Building wheels for collected packages: nbdev-colab-helper
  Building wheel for nbdev-colab-helper (setup.py) ... done
  Created wheel for nbdev-colab-helper: filename=nbdev_colab_helper-0.0.1-py3-none-any.whl size=9679 sha256=83f342c034baedf828bf009aba857a57ff470f507bbbe8a297e1b91638d23ad0
  Stored in directory: /tmp/pip-ephem-wheel-cache-srf4vk1b/wheels/0c/50/90/0c073bb88ab36268043083b5ee7bc3a8b39c1a423c3c3736b7
Successfully built nbdev-colab-helper
Installing collected packages: nbdev-colab-helper
Successfully installed nbdev-colab-helper-0.0.1
Connecting to google drive
Mounted at /content/drive
/content/drive/My Drive/Colab Notebooks/github/forecast_action
pip install fastscript==1.0.0 fastcore==1.0.8 nbdev==1.0.14
   Collecting fastscript==1.0.0
  Downloading fastscript-1.0.0-py3-none-any.whl (11 kB)
Collecting fastcore==1.0.8
  Downloading fastcore-1.0.8-py3-none-any.whl (37 kB)
Collecting nbdev==1.0.14
  Downloading nbdev-1.0.14-py3-none-any.whl (57 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 57.1/57.1 kB 5.7 MB/s eta 0:00:00
Requirement already satisfied: pip in /usr/local/lib/python3.10/dist-packages (from fastscript==1.0.0) (23.1.2)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from fastscript==1.0.0) (23.2)
Requirement already satisfied: nbformat&gt;=4.4.0 in /usr/local/lib/python3.10/dist-packages (from nbdev==1.0.14) (5.9.2)
Requirement already satisfied: nbconvert&gt;=5.6.1 in /usr/local/lib/python3.10/dist-packages (from nbdev==1.0.14) (6.5.4)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from nbdev==1.0.14) (6.0.1)
Requirement already satisfied: jupyter-client in /usr/local/lib/python3.10/dist-packages (from nbdev==1.0.14) (6.1.12)
Requirement already satisfied: ipykernel in /usr/local/lib/python3.10/dist-packages (from nbdev==1.0.14) (5.5.6)
Requirement already satisfied: lxml in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (4.9.4)
Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (4.12.3)
Requirement already satisfied: bleach in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (6.1.0)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.7.1)
Requirement already satisfied: entrypoints&gt;=0.2.2 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.4)
Requirement already satisfied: jinja2&gt;=3.0 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (3.1.3)
Requirement already satisfied: jupyter-core&gt;=4.7 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (5.7.1)
Requirement already satisfied: jupyterlab-pygments in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.3.0)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (2.1.5)
Requirement already satisfied: mistune&lt;2,&gt;=0.8.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.8.4)
Requirement already satisfied: nbclient&gt;=0.5.0 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.9.0)
Requirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (1.5.1)
Requirement already satisfied: pygments&gt;=2.4.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (2.16.1)
Requirement already satisfied: tinycss2 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (1.2.1)
Requirement already satisfied: traitlets&gt;=5.0 in /usr/local/lib/python3.10/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (5.7.1)
Requirement already satisfied: fastjsonschema in /usr/local/lib/python3.10/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (2.19.1)
Requirement already satisfied: jsonschema&gt;=2.6 in /usr/local/lib/python3.10/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (4.19.2)
Requirement already satisfied: ipython-genutils in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;nbdev==1.0.14) (0.2.0)
Requirement already satisfied: ipython&gt;=5.0.0 in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;nbdev==1.0.14) (7.34.0)
Requirement already satisfied: tornado&gt;=4.2 in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;nbdev==1.0.14) (6.3.3)
Requirement already satisfied: pyzmq&gt;=13 in /usr/local/lib/python3.10/dist-packages (from jupyter-client-&gt;nbdev==1.0.14) (23.2.1)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.10/dist-packages (from jupyter-client-&gt;nbdev==1.0.14) (2.8.2)
Requirement already satisfied: setuptools&gt;=18.5 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (67.7.2)
Collecting jedi&gt;=0.16 (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14)
  Downloading jedi-0.19.1-py2.py3-none-any.whl (1.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 38.3 MB/s eta 0:00:00
Requirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (4.4.2)
Requirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.7.5)
Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (3.0.43)
Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.2.0)
Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.1.6)
Requirement already satisfied: pexpect&gt;4.3 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (4.9.0)
Requirement already satisfied: attrs&gt;=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (23.2.0)
Requirement already satisfied: jsonschema-specifications&gt;=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (2023.12.1)
Requirement already satisfied: referencing&gt;=0.28.4 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (0.33.0)
Requirement already satisfied: rpds-py&gt;=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (0.18.0)
Requirement already satisfied: platformdirs&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from jupyter-core&gt;=4.7-&gt;nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (4.2.0)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.1-&gt;jupyter-client-&gt;nbdev==1.0.14) (1.16.0)
Requirement already satisfied: soupsieve&gt;1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4-&gt;nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (2.5)
Requirement already satisfied: webencodings in /usr/local/lib/python3.10/dist-packages (from bleach-&gt;nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.5.1)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.3 in /usr/local/lib/python3.10/dist-packages (from jedi&gt;=0.16-&gt;ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.8.3)
Requirement already satisfied: ptyprocess&gt;=0.5 in /usr/local/lib/python3.10/dist-packages (from pexpect&gt;4.3-&gt;ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.7.0)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;ipython&gt;=5.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.2.13)
Installing collected packages: jedi, fastscript, fastcore, nbdev
  Attempting uninstall: fastcore
    Found existing installation: fastcore 1.5.29
    Uninstalling fastcore-1.5.29:
      Successfully uninstalled fastcore-1.5.29
Successfully installed fastcore-1.0.8 fastscript-1.0.0 jedi-0.19.1 nbdev-1.0.14 
/content/drive/My Drive/Colab Notebooks/github/forecast_action
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_state_capitals" class="doc_header"><code>get_state_capitals</code><a href="__main__.py#L2" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_state_capitals</code>(<strong><code>geo_entry</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_lat_lon" class="doc_header"><code>get_lat_lon</code><a href="https://github.com/victorymr/forecast_action/tree/main/forecast_action/utils.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_lat_lon</code>(<strong><code>geo_input</code></strong>)</p>
</blockquote>
<p>Convert a geographical input (city, state, or country) into a list of latitude-longitude pairs.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_geo_query_list" class="doc_header"><code>create_geo_query_list</code><a href="https://github.com/victorymr/forecast_action/tree/main/forecast_action/utils.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_geo_query_list</code>(<strong><code>company_df</code></strong>, <strong><code>company_name</code></strong>)</p>
</blockquote>
<p>For a given company, generate a list of latitude-longitude pairs based on its 'Geo' field.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Rounded Coordinates for Chicago: Latitude 42.0, Longitude -87.75
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="round_to_grid" class="doc_header"><code>round_to_grid</code><a href="https://github.com/victorymr/forecast_action/tree/main/forecast_action/utils.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>round_to_grid</code>(<strong><code>lat</code></strong>, <strong><code>lon</code></strong>, <strong><code>resolution</code></strong>=<em><code>0.25</code></em>)</p>
</blockquote>
<p>Round latitude and longitude to the nearest grid resolution.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;lat_lon&#39;: (40.7128, -74.006), &#39;time_zone&#39;: &#39;America/New_York&#39;, &#39;local_peak_start&#39;: &#39;2024-03-07 05:00:00&#39;, &#39;local_peak_end&#39;: &#39;2024-03-07 12:00:00&#39;}
{&#39;lat_lon&#39;: (28.6139, 77.209), &#39;time_zone&#39;: &#39;Asia/Kolkata&#39;, &#39;local_peak_start&#39;: &#39;2024-03-07 15:30:00&#39;, &#39;local_peak_end&#39;: &#39;2024-03-07 22:30:00&#39;}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_local_peak_hours" class="doc_header"><code>get_local_peak_hours</code><a href="https://github.com/victorymr/forecast_action/tree/main/forecast_action/utils.py#L91" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_local_peak_hours</code>(<strong><code>lat_lons</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Timezone offset for latitude 40.7128, longitude -74.006 is -5.0 hours.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_timezone_offset" class="doc_header"><code>get_timezone_offset</code><a href="https://github.com/victorymr/forecast_action/tree/main/forecast_action/utils.py#L125" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_timezone_offset</code>(<strong><code>lat</code></strong>, <strong><code>lon</code></strong>, <strong><code>date</code></strong>=<em><code>datetime.datetime(2024, 3, 7, 20, 7, 22, 73229)</code></em>)</p>
</blockquote>
<p>Returns the timezone offset in hours for a given latitude, longitude, and date.</p>
<p>:param lat: Latitude of the location
:param lon: Longitude of the location
:param date: Date for which to find the timezone offset, default is current date
:return: Timezone offset in hours from UTC</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calculate_search_radius" class="doc_header"><code>calculate_search_radius</code><a href="https://github.com/victorymr/forecast_action/tree/main/forecast_action/utils.py#L151" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calculate_search_radius</code>(<strong><code>city_lat</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span>
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_core.ipynb.
Converted 01_utils.ipynb.
Converted index.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

